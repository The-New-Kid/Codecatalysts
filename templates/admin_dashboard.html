{% extends "admin_layout.html" %}
{% block title %}Mandir Dashboard{% endblock %}
{% block content %}

<!-- Page Heading -->
<h2 class="text-5xl sm:text-6xl font-extrabold text-transparent 
           bg-clip-text bg-gradient-to-r from-yellow-600 via-orange-500 to-red-500 
           text-center mb-12 leading-snug sm:leading-snug drop-shadow-lg" 
    style="padding-bottom: 6px;" data-aos="fade-down">
    Mandir Parking Lots
</h2>

<!-- Add Lot Button -->
<div class="text-center sm:text-right mb-10">
    <a href="{{ url_for('add_lot') }}"
       class="inline-block px-8 py-3 bg-gradient-to-r from-orange-500 to-red-500 text-white font-bold rounded-full shadow-lg hover:shadow-2xl transform hover:-translate-y-1 transition-all duration-300 text-lg"
       data-aos="fade-left">
        + Add Parking Lot
    </a>
</div>

<!-- Parking Lots Grid -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
    {% for lot in parking_lots %}
    <div class="bg-white rounded-3xl shadow-lg p-6 hover:shadow-2xl transform hover:-translate-y-2 transition-all duration-300 border-t-4 border-yellow-500" data-aos="fade-up">
        
        <!-- Lot Title -->
        <h3 class="text-2xl font-semibold mb-4 text-red-800">{{ lot.prime_location_name }}</h3>

        <!-- Legends -->
        <div class="flex flex-wrap gap-3 mb-4 text-sm font-medium text-gray-700">
            <span class="inline-flex items-center gap-1"><span class="w-4 h-4 bg-green-500 rounded-sm"></span>Normal</span>
            <span class="inline-flex items-center gap-1"><span class="w-4 h-4 bg-gray-400 rounded-sm"></span>Extra</span>
            <span class="inline-flex items-center gap-1"><span class="w-4 h-4 bg-pink-500 rounded-sm"></span>VIP</span>
            <span class="inline-flex items-center gap-1"><span class="w-4 h-4 bg-red-600 rounded-sm"></span>Occupied</span>
        </div>

        <!-- Actions -->
        <div class="flex gap-4 mb-4">
            <a href="{{url_for('edit_parking_lot',lot_id=lot.id)}}" 
               class="text-orange-600 font-semibold hover:text-orange-800 transition">Edit</a>
            <form action="{{ url_for('delete_parking_lot', lot_id=lot.id) }}" method="POST" 
                  onsubmit="return confirm('Are you sure you want to delete this parking lot?');">
                <button type="submit" class="text-red-600 font-semibold hover:text-red-800 transition">Delete</button>
            </form>
        </div>

        <!-- Occupied Info -->
        <p class="text-gray-600 mb-4 font-medium">
            Occupied: {{ lot.spots | selectattr('status', 'equalto', 'O') | list | length }}/{{ lot.max_spots }}
        </p>

        <!-- Spot Grid -->
        <div class="grid grid-cols-5 gap-3">
            {% for spot in lot.colored_spots %}
            <a href="{{ url_for('spot_detail', spot_id=spot.id) }}"
               class="flex items-center justify-center w-12 h-12 rounded-lg font-bold text-sm
                      {% if spot.color == 'green' %} bg-green-500 text-black {% elif spot.color == 'grey' %} bg-gray-400 text-white {% elif spot.color == 'pink' %} bg-pink-500 text-white {% endif %}
                      {% if spot.status == 'O' %} bg-red-600 text-white {% endif %}
                      hover:scale-110 transform transition-all duration-200 shadow-md">
               {% if spot.status == 'A' %}
                   {% if spot.color == 'green' %}A{% elif spot.color == 'grey' %}E{% elif spot.color == 'pink' %}V{% endif %}
               {% else %}
                   O
               {% endif %}
            </a>
            {% endfor %}
        </div>
    </div>
    {% endfor %}
</div>

<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
  AOS.init({ duration: 800, easing: 'ease-in-out', once: true });
</script>

{% endblock %}
